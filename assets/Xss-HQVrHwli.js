import{j as e}from"./index-BrPsnAZM.js";import{S as n}from"./styled-Bk4t2OUj.js";const t=()=>e.jsxs(n.Page,{children:[e.jsx(n.Title,{children:"XSS - Cross-Site Scripting"}),e.jsxs(n.Lead,{children:[e.jsx("b",{children:"Cross-Site Scripting (XSS)"})," is a vulnerability where an attacker injects",e.jsx("b",{children:" untrusted content"})," (often JavaScript) into a page so that it runs in the victim's browser under your site's origin. XSS lets attackers steal data (tokens, cookies), perform actions as the user, deface UI, or pivot to other attacks."]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Definition & Threat Model"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"XSS:"})," Executing attacker-controlled script in the context of your web origin."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Untrusted input:"})," Any data you don't fully control (user input, query params, URL hash, CMS fields, third-party APIs)."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Payload:"})," The injected content (e.g., ",e.jsx(n.InlineCode,{children:"<img onerror=...>"}),", ",e.jsx(n.InlineCode,{children:"<script>"}),", ",e.jsx(n.InlineCode,{children:"javascript:"})," URLs)."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Sink:"})," A place where that untrusted input is inserted into the DOM/HTML/JS (e.g., ",e.jsx(n.InlineCode,{children:"innerHTML"}),", ",e.jsx(n.InlineCode,{children:"dangerouslySetInnerHTML"}),", ",e.jsx(n.InlineCode,{children:"href"}),", inline event handlers)."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Impact:"})," Token/cookie theft, account takeover, fake forms, keylogging, CSRF bypass helpers, browser exploit delivery."]})]})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Types of XSS (with examples)"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Reflected XSS:"})," Payload comes from the request (URL/query) and is reflected into the response/DOM immediately.",e.jsx(n.Pre,{children:`// Example (anti-pattern): reading query and injecting directly
const params = new URLSearchParams(window.location.search);
const q = params.get("q"); // attacker controls
<div dangerouslySetInnerHTML={{ __html: q }} /> // ❌ reflected XSS`})]}),e.jsxs("li",{children:[e.jsx("b",{children:"Stored XSS:"})," Payload is persisted (DB/CMS/comment) and served to every viewer later.",e.jsx(n.Small,{children:"Most damaging because it hits many users without them clicking anything."})]}),e.jsxs("li",{children:[e.jsx("b",{children:"DOM-based XSS:"})," Client-side JS reads an untrusted value and writes it into a dangerous sink at runtime (no server needed).",e.jsx(n.Pre,{children:`// Example (anti-pattern): using hash as HTML
const raw = decodeURIComponent(window.location.hash.slice(1));
document.getElementById("slot").innerHTML = raw; // ❌ DOM XSS`})]}),e.jsxs("li",{children:[e.jsx("b",{children:"Self-XSS:"})," Social-engineering trick where users paste code into DevTools. Still dangerous for your users; educate and prevent."]})]})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"How React Helps - and Where It Doesn't"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Auto-escaping:"})," React escapes text interpolations, so"," ",e.jsx(n.InlineCode,{children:"<div>{userInput}</div>"})," renders as text, not HTML."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Danger zones:"})," ",e.jsx(n.InlineCode,{children:"dangerouslySetInnerHTML"}),", direct DOM APIs (",e.jsx(n.InlineCode,{children:"innerHTML"}),"), and setting sensitive attributes (",e.jsx(n.InlineCode,{children:"href"}),", ",e.jsx(n.InlineCode,{children:"src"}),") with untrusted data."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Event props:"})," React props like ",e.jsx(n.InlineCode,{children:"onClick"})," are functions; strings there don't get executed. But if you generate HTML strings with inline handlers (e.g., ",e.jsx(n.InlineCode,{children:'<div onclick="...">'}),") and inject them as HTML, they can run."]}),e.jsxs("li",{children:[e.jsx("b",{children:"URLs still risky:"})," If you do ",e.jsx(n.InlineCode,{children:"<a href={userHref}>"}),", React sets the attribute. You must validate and disallow ",e.jsx(n.InlineCode,{children:"javascript:"}),", ",e.jsx(n.InlineCode,{children:"data:text/html"}),", etc."]})]})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Vulnerable vs Safe Patterns"}),e.jsx(n.H3,{children:"❌ Vulnerable: injecting untrusted HTML"}),e.jsx(n.Pre,{children:`// DO NOT: render untrusted HTML
function Bio({ aboutHtml }) {
  return <div dangerouslySetInnerHTML={{ __html: aboutHtml }} />; // ❌
}`}),e.jsx(n.H3,{children:"✅ Safe: render as text (preferred)"}),e.jsx(n.Pre,{children:`function Bio({ aboutText }) {
  return <p>{aboutText}</p>; // React escapes text safely
}`}),e.jsx(n.H3,{children:"✅ If you MUST render HTML, sanitize first"}),e.jsxs(n.Small,{children:["Use a robust sanitizer. On the client, a common choice is DOMPurify; on the server, libraries like ",e.jsx("i",{children:"sanitize-html"}),"."]}),e.jsx(n.Pre,{children:`// Example idea (client): sanitize then set
import DOMPurify from "dompurify";
function SafeHtml({ html }) {
  const clean = React.useMemo(() => DOMPurify.sanitize(html, { USE_PROFILES: { html: true } }), [html]);
  return <div dangerouslySetInnerHTML={{ __html: clean }} />;
}`}),e.jsx(n.H3,{children:"✅ Validate URLs before using them"}),e.jsx(n.Pre,{children:`function isSafeHttpUrl(u) {
  try {
    const url = new URL(u, window.location.origin);
    const scheme = url.protocol.toLowerCase();
    return scheme === "http:" || scheme === "https:";
  } catch { return false; }
}

function SafeLink({ href, children }) {
  const safe = isSafeHttpUrl(href) ? href : "#";
  return <a href={safe} rel="noopener noreferrer">{children}</a>;
}`})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Defense in Depth"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Sanitization:"})," Strip/neutralize dangerous HTML (tags/attrs) before display. Do it as close to the source as possible (server/CMS) and again at the edge if needed."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Context-aware encoding:"})," Escape differently for contexts - HTML text, HTML attribute, URL, JS string, CSS."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Content Security Policy (CSP):"})," HTTP header that limits where scripts come from. Disallow inline scripts to massively reduce XSS blast radius.",e.jsx(n.Pre,{children:`// Example CSP (strict baseline)
// Content-Security-Policy:
default-src 'self';
script-src 'self'; object-src 'none';
base-uri 'none'; frame-ancestors 'none';
img-src 'self' data: https:;
style-src 'self' 'unsafe-inline'; /* better: use nonces */
upgrade-insecure-requests;`})]}),e.jsxs("li",{children:[e.jsx("b",{children:"Trusted Types:"})," Browser feature forcing dangerous sinks to accept only vetted values. Great with frameworks and CSP."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Cookie hardening:"})," Use ",e.jsx(n.InlineCode,{children:"HttpOnly"})," (not readable by JS), ",e.jsx(n.InlineCode,{children:"Secure"}),", and ",e.jsx(n.InlineCode,{children:"SameSite"}),". Reduces XSS token theft impact and helps with CSRF."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Token placement:"})," Prefer server-set ",e.jsx(n.InlineCode,{children:"HttpOnly"})," cookies over storing secrets in ",e.jsx(n.InlineCode,{children:"localStorage"}),". If XSS happens, ",e.jsx(n.InlineCode,{children:"localStorage"})," tokens are trivial to steal."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Avoid inline JS/HTML building:"})," No string-concatenated HTML; no inline event handlers; no unsanitized markdown to HTML."]})]})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Testing & Finding XSS (safely)"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Probe payloads:"})," Try harmless markers like ",e.jsx(n.InlineCode,{children:'"><svg onload=alert(1)>'})," in fields that might render as HTML. If an alert pops, there's likely an XSS sink. Use a throwaway environment."]}),e.jsxs("li",{children:[e.jsx("b",{children:"URL tests:"})," Ensure ",e.jsx(n.InlineCode,{children:"javascript:"})," links are blocked; test ",e.jsx(n.InlineCode,{children:"data:text/html,"})," and malformed schemes."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Automate:"})," Add linters/SAST/DAST and review any usage of ",e.jsx(n.InlineCode,{children:"dangerouslySetInnerHTML"})," or direct DOM writes."]})]})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Do & Don't"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Do"})," treat all external data as untrusted and validate early."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Do"})," render untrusted content as text; sanitize if you must render HTML."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Do"})," set a strict CSP and consider Trusted Types."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Don't"})," store tokens in ",e.jsx(n.InlineCode,{children:"localStorage"}),"; prefer ",e.jsx(n.InlineCode,{children:"HttpOnly"})," cookies."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Don't"})," pass raw HTML props down your React tree; keep data/text separate from presentation."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Don't"})," whitelist everything - define minimal allowed tags/attrs when sanitizing."]})]})]}),e.jsxs(n.Section,{children:[e.jsx(n.H2,{children:"Glossary"}),e.jsxs(n.List,{children:[e.jsxs("li",{children:[e.jsx("b",{children:"Sanitization:"})," Removing/neutralizing dangerous parts of HTML."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Encoding/Escaping:"})," Representing characters safely for a specific context so they aren't interpreted as code."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Sink:"})," DOM/HTML/JS location where untrusted input gets interpreted (e.g., ",e.jsx(n.InlineCode,{children:"innerHTML"}),")."]}),e.jsxs("li",{children:[e.jsx("b",{children:"Nonce:"})," Random token used in CSP to allow only scripts/styles that carry that token."]}),e.jsxs("li",{children:[e.jsx("b",{children:"HttpOnly cookie:"})," Cookie that JS cannot read, mitigating theft via XSS."]}),e.jsxs("li",{children:[e.jsx("b",{children:"SameSite cookie:"})," Restricts cross-site sending of cookies to help prevent CSRF."]})]})]}),e.jsxs(n.Callout,{children:["Summary: Prevent XSS by defaulting to ",e.jsx("b",{children:"render as text"}),", sanitizing any HTML, validating URLs, setting a ",e.jsx("b",{children:"strict CSP"}),", and keeping tokens in ",e.jsx("b",{children:"HttpOnly cookies"}),". React protects common cases, but sinks like ",e.jsx("i",{children:"dangerouslySetInnerHTML"})," and direct DOM writes still require discipline."]})]});export{t as default};
